<div class="d-flex min-vh-100">
    <%- include("../../partials/sidebar") %>
  
    <div class="flex-grow-1 d-flex justify-content-center lign-items-start px-3 mt-4 forsmtest">
      <div class="w-100" style="max-width: 700px;">
        <div class="card border-warning shadow-sm p-4 bg-light rounded form-bg">
          <h2 class="text-center mb-4">Edit Client</h2>
  
          <% if (errors && errors.length > 0) { %>
            <div class="alert alert-danger">
              <ul class="mb-0">
                <% errors.forEach(err => { %>
                  <li><%= err.msg %></li>
                <% }) %>
              </ul>
            </div>
          <% } %>
  
          <form method="POST" action="/clients/update/<%= oldData.client_id %>">
  
            <!-- Client Info -->
            <h4 class="mt-4 border-bottom pb-2">Client Info</h4>
  
            <div class="mb-3">
              <label for="first_name" class="form-label">First Name</label>
              <input type="text" name="first_name" id="first_name"
                class="form-control <%= errors.find(e => e.param === 'first_name') ? 'is-invalid' : '' %>"
                value="<%= oldData.first_name || '' %>">
              <% const err1 = errors.find(e => e.param === 'first_name'); if (err1) { %>
                <div class="invalid-feedback"><%= err1.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="last_name" class="form-label">Last Name</label>
              <input type="text" name="last_name" id="last_name"
                class="form-control <%= errors.find(e => e.param === 'last_name') ? 'is-invalid' : '' %>"
                value="<%= oldData.last_name || '' %>">
              <% const err2 = errors.find(e => e.param === 'last_name'); if (err2) { %>
                <div class="invalid-feedback"><%= err2.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="phone_number" class="form-label">Phone Number</label>
              <input type="tel" name="phone_number" id="phone_number"
                class="form-control <%= errors.find(e => e.param === 'phone_number') ? 'is-invalid' : '' %>"
                value="<%= oldData.phone_number || '' %>">
              <% const err3 = errors.find(e => e.param === 'phone_number'); if (err3) { %>
                <div class="invalid-feedback"><%= err3.msg %></div>
              <% } %>
            </div>
  
            <!-- Address -->
            <h4 class="mt-4 border-bottom pb-2">Address</h4>
  
            <div class="mb-3">
              <label for="street" class="form-label">Street</label>
              <input type="text" name="street" id="street" class="form-control" value="<%= oldData.street || '' %>" required>
            </div>
  
            <div class="mb-3">
              <label for="city" class="form-label">City</label>
              <input type="text" name="city" id="city" class="form-control" value="<%= oldData.city || '' %>" required>
            </div>
  
            <div class="mb-3">
              <label for="zip" class="form-label">ZIP Code</label>
              <input type="text" name="zip" id="zip" class="form-control" value="<%= oldData.zip || '' %>" required>
            </div>
  
            <div class="mb-3">
              <label for="garage_code" class="form-label">Garage Code (if any)</label>
              <input type="text" name="garage_code" id="garage_code" class="form-control" value="<%= oldData.garage_code || '' %>">
            </div>
  
            <!-- Service Details -->
            <h4 class="mt-4 border-bottom pb-2">Service Details</h4>
  
            <div class="mb-3">
              <label for="hired_date" class="form-label">Hired Date</label>
              <input type="date" name="hired_date" id="hired_date"
                class="form-control <%= errors.find(e => e.param === 'hired_date') ? 'is-invalid' : '' %>"
                value="<%= oldData.hired_date || '' %>">
              <% const err4 = errors.find(e => e.param === 'hired_date'); if (err4) { %>
                <div class="invalid-feedback"><%= err4.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="service_hours" class="form-label">Service Hours</label>
              <input type="number" step="0.25" name="service_hours" id="service_hours"
                class="form-control <%= errors.find(e => e.param === 'service_hours') ? 'is-invalid' : '' %>"
                value="<%= oldData.service_hours || '' %>">
              <% const err5 = errors.find(e => e.param === 'service_hours'); if (err5) { %>
                <div class="invalid-feedback"><%= err5.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="preferred_day" class="form-label">Preferred Day</label>
              <select name="preferred_day" id="preferred_day"
                class="form-select <%= errors.find(e => e.param === 'preferred_day') ? 'is-invalid' : '' %>">
                <option value="M" <%= oldData.preferred_day==='M' ? 'selected' : '' %>>Monday</option>
                <option value="TUE" <%= oldData.preferred_day==='TUE' ? 'selected' : '' %>>Tuesday</option>
                <option value="W" <%= oldData.preferred_day==='W' ? 'selected' : '' %>>Wednesday</option>
                <option value="TH" <%= oldData.preferred_day==='TH' ? 'selected' : '' %>>Thursday</option>
                <option value="F" <%= oldData.preferred_day==='F' ? 'selected' : '' %>>Friday</option>
                <option value="NOTSET" <%= oldData.preferred_day==='NOTSET' ? 'selected' : '' %>>Not Set</option>
              </select>
              <% const err6 = errors.find(e => e.param === 'preferred_day'); if (err6) { %>
                <div class="invalid-feedback"><%= err6.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="service_type_id" class="form-label">Service Type</label>
              <select name="service_type_id" id="service_type_id"
                class="form-control <%= errors.find(e => e.param === 'service_type_id') ? 'is-invalid' : '' %>">
                <option value="">-- Select a service type --</option>
                <% serviceTypes.forEach(type => { %>
                  <option value="<%= type.service_id %>" <%= oldData.service_type_id == type.service_id ? 'selected' : '' %>>
                    <%= type.service_frequency %>
                  </option>
                <% }) %>
              </select>
              <% const err7 = errors.find(e => e.param === 'service_type_id'); if (err7) { %>
                <div class="invalid-feedback"><%= err7.msg %></div>
              <% } %>
            </div>
  
            <div class="mb-3">
              <label for="is_active" class="form-label">Status</label>
              <select name="is_active" id="is_active"
                class="form-select <%= errors.find(e => e.param === 'is_active') ? 'is-invalid' : '' %>">
                <option value="active" <%= oldData.is_active === 'active' ? 'selected' : '' %>>Active</option>
                <option value="inactive" <%= oldData.is_active === 'inactive' ? 'selected' : '' %>>Inactive</option>
              </select>
              <% const err8 = errors.find(e => e.param === 'is_active'); if (err8) { %>
                <div class="invalid-feedback"><%= err8.msg %></div>
              <% } %>
            </div>
  
            <button type="submit" class="btn btn-warning w-100 mt-3">Update Client</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  